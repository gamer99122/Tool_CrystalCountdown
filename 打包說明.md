# æ¡Œé¢å…¬å‘Šå°å·¥å…· - æ‰“åŒ…èªªæ˜

## ğŸ“¦ å¿«é€Ÿæ‰“åŒ…æ–¹æ³•

### æ–¹æ³• 1ï¼šä½¿ç”¨æ‰¹æ¬¡æª”ï¼ˆæ¨è–¦ Windows ç”¨æˆ¶ï¼‰

1. é›™æ“Š `publish.bat`
2. ç­‰å¾…æ‰“åŒ…å®Œæˆ
3. è‡ªå‹•é–‹å•Ÿç™¼å¸ƒè³‡æ–™å¤¾

### æ–¹æ³• 2ï¼šä½¿ç”¨ PowerShell è…³æœ¬

1. å³éµé»æ“Š `publish.ps1`
2. é¸æ“‡ã€Œä½¿ç”¨ PowerShell åŸ·è¡Œã€
3. å¦‚æœå‡ºç¾åŸ·è¡ŒåŸå‰‡éŒ¯èª¤ï¼Œå…ˆåŸ·è¡Œï¼š
   ```powershell
   Set-ExecutionPolicy -Scope CurrentUser RemoteSigned
   ```

### æ–¹æ³• 3ï¼šæ‰‹å‹•æŒ‡ä»¤

é–‹å•Ÿå‘½ä»¤æç¤ºå­—å…ƒæˆ– PowerShellï¼ŒåŸ·è¡Œï¼š

```bash
# å®Œæ•´ç‰ˆï¼ˆåŒ…å«æ‰€æœ‰å„ªåŒ–ï¼Œæ¨è–¦ï¼‰
dotnet publish -c Release -r win-x64 --self-contained true -p:PublishSingleFile=true -p:IncludeNativeLibrariesForSelfExtract=true -p:EnableCompressionInSingleFile=true

# ç°¡åŒ–ç‰ˆï¼ˆåŸºæœ¬æ‰“åŒ…ï¼‰
dotnet publish -c Release -r win-x64 --self-contained -p:PublishSingleFile=true

# è¼•é‡ç‰ˆï¼ˆéœ€è¦ä½¿ç”¨è€…å®‰è£ .NET 8ï¼‰
dotnet publish -c Release -r win-x64 --self-contained false -p:PublishSingleFile=true
```

---

## ğŸ”§ æŒ‡ä»¤åƒæ•¸è©³è§£

### åŸºæœ¬åƒæ•¸

| åƒæ•¸ | èªªæ˜ | ç¯„ä¾‹å€¼ |
|------|------|--------|
| `-c` | ç·¨è­¯æ¨¡å¼ | `Release` æˆ– `Debug` |
| `-r` | ç›®æ¨™å¹³å° | `win-x64`, `win-x86`, `linux-x64` |
| `--self-contained` | åŒ…å« Runtime | `true` (69MB) æˆ– `false` (5MB) |

### é€²éšåƒæ•¸

| åƒæ•¸ | ç”¨é€” | æ•ˆæœ |
|------|------|------|
| `-p:PublishSingleFile=true` | å–®ä¸€æª”æ¡ˆ | æ‰€æœ‰æª”æ¡ˆæ‰“åŒ…æˆä¸€å€‹ .exe |
| `-p:IncludeNativeLibrariesForSelfExtract=true` | åŒ…å«åŸç”Ÿåº« | Win32 API ä¹Ÿè¢«æ‰“åŒ… |
| `-p:EnableCompressionInSingleFile=true` | å£“ç¸®æª”æ¡ˆ | æ¸›å°‘ .exe å¤§å° |
| `-p:PublishTrimmed=true` | è£å‰ªæœªä½¿ç”¨ç¨‹å¼ç¢¼ | é€²ä¸€æ­¥æ¸›å°æª”æ¡ˆ |

---

## ğŸ“ ç™¼å¸ƒä½ç½®

åŸ·è¡Œæ‰“åŒ…å¾Œï¼Œæª”æ¡ˆæœƒå‡ºç¾åœ¨ï¼š

```
bin/Release/net8.0-windows/win-x64/publish/
â”œâ”€â”€ DesktopAnnouncement.exe  â† ä¸»ç¨‹å¼
â”œâ”€â”€ config.txt               â† è¨­å®šæª”
â””â”€â”€ DesktopAnnouncement.pdb  â† é™¤éŒ¯ç¬¦è™Ÿï¼ˆå¯åˆªé™¤ï¼‰
```

---

## ğŸ¯ ä¸åŒå ´æ™¯çš„æ‰“åŒ…å»ºè­°

### å ´æ™¯ 1ï¼šåˆ†äº«çµ¦æœ‹å‹ä½¿ç”¨
```bash
# ä½¿ç”¨å®Œæ•´æ‰“åŒ…ï¼Œç¢ºä¿å°æ–¹ä¸éœ€è¦å®‰è£ä»»ä½•æ±è¥¿
dotnet publish -c Release -r win-x64 --self-contained true -p:PublishSingleFile=true
```
- âœ… å°æ–¹ä¸éœ€è¦å®‰è£ .NET
- âœ… é›™æ“Šå³å¯åŸ·è¡Œ
- âŒ æª”æ¡ˆè¼ƒå¤§ï¼ˆç´„ 69MBï¼‰

### å ´æ™¯ 2ï¼šè‡ªå·±ä½¿ç”¨æˆ–åˆ†äº«çµ¦é–‹ç™¼è€…
```bash
# ä½¿ç”¨è¼•é‡æ‰“åŒ…ï¼Œæª”æ¡ˆå°ä½†éœ€è¦ .NET Runtime
dotnet publish -c Release -r win-x64 --self-contained false -p:PublishSingleFile=true
```
- âœ… æª”æ¡ˆå°ï¼ˆç´„ 5-10MBï¼‰
- âŒ éœ€è¦å®‰è£ .NET 8 Runtime

### å ´æ™¯ 3ï¼šè¿½æ±‚æ¥µè‡´å°æª”æ¡ˆ
```bash
# ä½¿ç”¨è£å‰ªåŠŸèƒ½ï¼ˆå¯èƒ½ç§»é™¤æœªä½¿ç”¨çš„ç¨‹å¼ç¢¼ï¼‰
dotnet publish -c Release -r win-x64 --self-contained true -p:PublishSingleFile=true -p:PublishTrimmed=true
```
- âœ… æª”æ¡ˆæ›´å°ï¼ˆç´„ 40-50MBï¼‰
- âš ï¸ éœ€è¦æ¸¬è©¦ç¢ºä¿åŠŸèƒ½æ­£å¸¸

---

## ğŸš€ å…¶ä»–å¹³å°æ‰“åŒ…

### Windows 32ä½å…ƒ
```bash
dotnet publish -c Release -r win-x86 --self-contained true -p:PublishSingleFile=true
```

### Linux
```bash
dotnet publish -c Release -r linux-x64 --self-contained true -p:PublishSingleFile=true
```

### macOS
```bash
dotnet publish -c Release -r osx-x64 --self-contained true -p:PublishSingleFile=true
```

---

## âš¡ æ•ˆèƒ½æ¯”è¼ƒ

| æ–¹å¼ | æª”æ¡ˆå¤§å° | å•Ÿå‹•é€Ÿåº¦ | éœ€è¦ Runtime |
|------|----------|----------|--------------|
| å–®ä¸€æª”æ¡ˆ + Runtime | 69MB | ä¸­ç­‰ | âŒ |
| å–®ä¸€æª”æ¡ˆï¼ˆç„¡ Runtimeï¼‰ | 5MB | å¿« | âœ… |
| å¤šæª”æ¡ˆ + Runtime | 70MB | å¿« | âŒ |
| è£å‰ªç‰ˆ | 40-50MB | ä¸­ç­‰ | âŒ |

---

## ğŸ’¡ å°æŠ€å·§

### 1. è‡ªå‹•åŒ–æ‰“åŒ…ä¸¦å£“ç¸®æˆ ZIP
åœ¨ `publish.bat` æœ€å¾ŒåŠ å…¥ï¼š
```batch
powershell Compress-Archive -Path "DesktopAnnouncement_ç™¼å¸ƒç‰ˆ\*" -DestinationPath "DesktopAnnouncement_v1.0.zip" -Force
```

### 2. è¨­å®šç‰ˆæœ¬è™Ÿ
åœ¨ `.csproj` æª”æ¡ˆä¸­åŠ å…¥ï¼š
```xml
<PropertyGroup>
  <Version>1.0.0</Version>
  <AssemblyVersion>1.0.0.0</AssemblyVersion>
</PropertyGroup>
```

### 3. æ·»åŠ åœ–ç¤º
```xml
<PropertyGroup>
  <ApplicationIcon>app.ico</ApplicationIcon>
</PropertyGroup>
```

---

## ğŸ” å¸¸è¦‹å•é¡Œ

### Q: ç‚ºä»€éº¼æª”æ¡ˆé€™éº¼å¤§ï¼Ÿ
A: å› ç‚ºåŒ…å«äº†å®Œæ•´çš„ .NET Runtimeã€‚å¦‚æœä½¿ç”¨è€…å·²å®‰è£ .NETï¼Œå¯ä»¥ç”¨ `--self-contained false` æ¸›å°æª”æ¡ˆã€‚

### Q: å¯ä»¥è®“æª”æ¡ˆæ›´å°å—ï¼Ÿ
A: å¯ä»¥ä½¿ç”¨ `-p:PublishTrimmed=true`ï¼Œä½†éœ€è¦æ¸¬è©¦ç¢ºä¿åŠŸèƒ½æ­£å¸¸ã€‚

### Q: å¦‚ä½•æ‰“åŒ…æˆå®‰è£ç¨‹å¼ï¼Ÿ
A: å¯ä»¥ä½¿ç”¨ Inno Setup æˆ– WiX Toolset å»ºç«‹å®‰è£ç¨‹å¼ã€‚

### Q: ç™¼å¸ƒå¾Œç„¡æ³•åŸ·è¡Œï¼Ÿ
A: æª¢æŸ¥é˜²æ¯’è»Ÿé«”æ˜¯å¦é˜»æ“‹ï¼Œæˆ–ç¢ºèªç›®æ¨™é›»è…¦æ˜¯ 64 ä½å…ƒç³»çµ±ã€‚

---

## ğŸ“š åƒè€ƒè³‡æ–™

- [.NET ç™¼å¸ƒå®˜æ–¹æ–‡ä»¶](https://learn.microsoft.com/zh-tw/dotnet/core/deploying/)
- [å–®ä¸€æª”æ¡ˆéƒ¨ç½²](https://learn.microsoft.com/zh-tw/dotnet/core/deploying/single-file/)
- [è£å‰ªéƒ¨ç½²](https://learn.microsoft.com/zh-tw/dotnet/core/deploying/trimming/)
